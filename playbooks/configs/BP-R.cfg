hostname BP-R1
ip domain name bp.solardynamics.eu
banner login #WARNING: Unauthorized access is strictly prohibited. This device is the property of the Solar Dynamics corporation and is only for authorized use. Any unauthorized access or attempt to gain access to this device will reported#
banner incoming #WARNING: Unauthorized access is strictly prohibited. This device is the property of the Solar Dynamics corporation and is only for authorized use. Any unauthorized access or attempt to gain access to this device will reported#
banner exec #WARNING: Unauthorized access is strictly prohibited. This device is the property of the Solar Dynamics corporation and is only for authorized use. Any unauthorized access or attempt to gain access to this device will reported#
ip name-server 10.0.70.20 1.1.1.1
ip domain lookup
ipv6 unicast-routing

interface GigabitEthernet0/0
    description Link to ISP
    ip address 82.1.79.33 255.255.255.224
    ipv6 address 2a:1dc:7c0:02FF:82:1:79:33/64
    ipv6 eigrp 100
    ip nat outside
    no shutdown
interface GigabitEthernet1/0
    description Link to BP-MLS1
    ip address 172.16.2.0 255.255.255.254
    ipv6 enable
    ipv6 eigrp 100
    ip nat inside
    no shutdown
interface GigabitEthernet2/0
    description Link to BP-MLS2
    ip address 172.16.2.2 255.255.255.254
    ipv6 enable
    ipv6 eigrp 100
    ip nat inside
    no shutdown
ip route 0.0.0.0 0.0.0.0 82.1.79.62
ipv6 route ::/0 GigabitEthernet2/0
ip access-list standard BP-ACL-internal-client
    permit 10.2.10.0 0.0.0.255
    permit 10.2.20.0 0.0.0.255
    permit 10.2.30.0 0.0.0.255
    permit 10.2.40.0 0.0.0.255
    permit 10.2.45.0 0.0.0.255
    permit 10.2.50.0 0.0.0.255
    permit 10.2.55.0 0.0.0.255
    permit 10.2.60.0 0.0.0.255
    permit 10.0.70.0 0.0.0.255
    permit 10.0.220.0 0.0.0.255

ip access-list standard BP-ACL-external-client
    permit 10.2.150.0 0.0.0.255


ip nat pool BP-internal-client-pool 82.1.79.40 82.1.79.45 netmask 255.255.255.224
ip nat inside source list BP-ACL-internal-client pool BP-internal-client-pool overload

ip nat pool BP-external-client-pool 82.1.79.46 82.1.79.50 netmask 255.255.255.224
ip nat inside source list BP-ACL-external-client pool BP-external-client-pool overload
crypto isakmp policy 10
    encr aes 256
    hash sha256
    authentication pre-share
    group 14
    lifetime 86400
crypto isakmp key Solar-Dynamics-2025 address 0.0.0.0 0.0.0.0
crypto ipsec transform-set DMVPN-TRANSFORM-SET esp-aes 256 esp-sha256-hmac
    mode transport
crypto ipsec profile DMVPN-PROFILE
    set transform-set DMVPN-TRANSFORM-SET

interface Tunnel0
    ip address 192.168.0.4 255.255.255.0
    no ip redirects
    no ip next-hop-self eigrp 100
    no ip split-horizon eigrp 100
    ip nhrp authentication Password
    ip nhrp network-id 1
    ip nhrp holdtime 600
    ip nhrp map multicast 192.168.0.1
    ip nhrp map 192.168.0.1 82.1.79.1
    ip nhrp nhs 192.168.0.1 
    ip nhrp map multicast 192.168.0.2
    ip nhrp map 192.168.0.2 85.16.100.3
    ip nhrp nhs 192.168.0.2 
    tunnel source 82.1.79.33
    tunnel mode gre multipoint
    tunnel key 123
    tunnel protection ipsec profile DMVPN-PROFILE
    ip mtu 1400
    ip tcp adjust-mss 1360
    bandwidth 1000000
    no shutdown
router eigrp 100
    network 172.16.2.0 0.0.0.1
    network 172.16.2.2 0.0.0.1
    network 192.168.0.0 0.0.0.255
    network 82.1.79.32 0.0.0.31
    no auto-summary
    passive-interface default
        redistribute static metric 10000 100 255 1 1500
        no passive-interface GigabitEthernet0/0
    no passive-interface GigabitEthernet1/0
    no passive-interface GigabitEthernet2/0
    no passive-interface Tunnel0

ipv6 router eigrp 100
    router-id 0.2.0.1
    passive-interface default

snmp-server view root iso included
snmp-server group bp.solardynamics.eu v3 priv write root
snmp-server user solaire bp.solardynamics.eu v3 auth md5 Solar-Dynamics-2025 priv des Solar-Dynamics-2025
snmp-server host 10.0.70.11 version 3 priv solaire
snmp-server enable traps
